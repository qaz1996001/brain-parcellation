import json
import os
import pathlib
import sys

import httpx

sys.path.append(str(pathlib.Path(__file__).parent.parent.parent.absolute()))
from code_ai import load_dotenv
from backend.app.sync import urls as sync_urls
from backend.app.sync.schemas import DCOPEventRequest

if __name__ == '__main__':
    # load_dotenv()
    UPLOAD_DATA_API_URL = os.getenv("UPLOAD_DATA_API_URL")
    # print("{}{}".format(UPLOAD_DATA_API_URL, sync_urls.SYNC_PROT_OPE_NO))
    # data_dict = {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "0c0a1444-9238e5ad-fbcd0251-335322e7-9af7b058", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": None, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/0c0a1444-9238e5ad-fbcd0251-335322e7-9af7b058/MR000000.dcm", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1FLAIR_AXI/MR000000.dcm"}}
    # dcop_event_dict = DCOPEventRequest.model_validate(data_dict)
    # print(dcop_event_dict)
    # print(json.dumps(data_list))
    data_list = ('[{"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "0c0a1444-9238e5ad-fbcd0251-335322e7-9af7b058", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/0c0a1444-9238e5ad-fbcd0251-335322e7-9af7b058", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1FLAIR_AXI"}},'
                 ' {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "308454c5-d2ff7ec1-74ce99a4-4281ba1b-a3a1d20b", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/308454c5-d2ff7ec1-74ce99a4-4281ba1b-a3a1d20b", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/DWI1000"}},'
                 ' {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "308454c5-d2ff7ec1-74ce99a4-4281ba1b-a3a1d20b", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/308454c5-d2ff7ec1-74ce99a4-4281ba1b-a3a1d20b", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/DWI0"}},'
                 ' {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "30b67051-ea598840-3d7e18d5-7ca18e99-b5812b64", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/30b67051-ea598840-3d7e18d5-7ca18e99-b5812b64", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/MRAVR_BRAIN"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "31fb1be1-71d25700-b131126f-c73708af-42d28093", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/31fb1be1-71d25700-b131126f-c73708af-42d28093", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/MRAVR_BRAIN"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "480d0af9-1b354283-1275c5a9-779d1d19-f5badec3", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/480d0af9-1b354283-1275c5a9-779d1d19-f5badec3", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/SWAN"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "4a128011-eb094052-044f0a9b-dad8e303-d1bd2514", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/4a128011-eb094052-044f0a9b-dad8e303-d1bd2514", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T2_COR"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "4fd61075-0d21921e-6f493a03-06f34542-791c1ef8", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/4fd61075-0d21921e-6f493a03-06f34542-791c1ef8", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/DSC"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "580ada15-b16f5062-e11479b7-3cc015a5-ca9d5b71", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/580ada15-b16f5062-e11479b7-3cc015a5-ca9d5b71", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1CUBECE_AXIr"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "580ada15-b16f5062-e11479b7-3cc015a5-ca9d5b71", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/580ada15-b16f5062-e11479b7-3cc015a5-ca9d5b71", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1CUBECE_SAGr"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "5828992d-127486bb-31d8ffb4-b6303e9e-bcc8127d", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/5828992d-127486bb-31d8ffb4-b6303e9e-bcc8127d", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/MRA_NECK"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "5a01d8bd-a9b020b4-508e6b1f-55c112ef-cdb28595", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/5a01d8bd-a9b020b4-508e6b1f-55c112ef-cdb28595", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/SWANmIP"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "5a01d8bd-a9b020b4-508e6b1f-55c112ef-cdb28595", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/5a01d8bd-a9b020b4-508e6b1f-55c112ef-cdb28595", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/SWAN"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "7343d7a3-dbd8985b-83cb9baf-a6a82f09-b81c0a0f", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/7343d7a3-dbd8985b-83cb9baf-a6a82f09-b81c0a0f", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/ADC"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "767b7a86-3609ad08-41f1e8bd-c2ffcd1e-d52c404f", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/767b7a86-3609ad08-41f1e8bd-c2ffcd1e-d52c404f", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/MRA_BRAIN"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "86364c14-51867d5e-4ecffab6-36054e99-ad1ff077", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/86364c14-51867d5e-4ecffab6-36054e99-ad1ff077", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/ADC"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "864b5235-e269bd92-be2fb3b3-43b18f0f-bf580226", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/864b5235-e269bd92-be2fb3b3-43b18f0f-bf580226", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/DSCCBV_COLOR"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "88fc5a1e-70f3a268-83359e24-b7d02988-7597e83e", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/88fc5a1e-70f3a268-83359e24-b7d02988-7597e83e", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1CUBE_AXIr"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "88fc5a1e-70f3a268-83359e24-b7d02988-7597e83e", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/88fc5a1e-70f3a268-83359e24-b7d02988-7597e83e", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1CUBE_SAGr"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "892668ed-e963f615-f0195a24-3d94eb0c-716a0d68", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/892668ed-e963f615-f0195a24-3d94eb0c-716a0d68", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1CUBECE_CORr"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "892668ed-e963f615-f0195a24-3d94eb0c-716a0d68", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/892668ed-e963f615-f0195a24-3d94eb0c-716a0d68", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1CUBECE_SAGr"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "8cfeeef5-d528b61a-7163c714-5f8dc536-84b3378f", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/8cfeeef5-d528b61a-7163c714-5f8dc536-84b3378f", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1CUBE_SAG"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "acbbeffd-0e3771a9-6df1df86-fe5a1c68-445cdc30", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/acbbeffd-0e3771a9-6df1df86-fe5a1c68-445cdc30", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/DSCMTT_COLOR"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "c411a7cd-00b1a6c9-9f294a8d-55e21f32-ed24927f", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/c411a7cd-00b1a6c9-9f294a8d-55e21f32-ed24927f", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/MRAVR_NECK"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "d3d8366b-9c601d4c-277f4ec6-ff7d14f4-14a0c7d0", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/d3d8366b-9c601d4c-277f4ec6-ff7d14f4-14a0c7d0", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1CUBECE_SAG"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "d66c9459-b7096a5c-ebe75fff-aee4b22f-ce9e8ea3", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/d66c9459-b7096a5c-ebe75fff-aee4b22f-ce9e8ea3", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1CUBE_CORr"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "d66c9459-b7096a5c-ebe75fff-aee4b22f-ce9e8ea3", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/d66c9459-b7096a5c-ebe75fff-aee4b22f-ce9e8ea3", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T1CUBE_SAGr"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "ec07e170-f167ee5d-503ee7cd-becd8038-c48dedab", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/ec07e170-f167ee5d-503ee7cd-becd8038-c48dedab", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/SWANPHASE"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "f65fe67c-f5f69656-73afb17b-b0c465a1-6bc7f053", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/f65fe67c-f5f69656-73afb17b-b0c465a1-6bc7f053", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/DSCCBF_COLOR"}}, {"study_uid": "ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30", "series_uid": "fc340cd5-37fe175d-ed6feb62-bab88fdf-9850e140", "ope_no": "100.095", "tool_id": "DICOM_TOOL", "study_id": "10089413_20210201_MR_21002010079", "params_data": null, "result_data": {"raw_dicom_path": "/mnt/e/raw_dicom/ee5f44b1-e1f0dc1c-8825e04b-d5fb7bae-0373ba30/fc340cd5-37fe175d-ed6feb62-bab88fdf-9850e140", "rename_dicom_path": "/mnt/e/pipeline/sean/rename_dicom/10089413_20210201_MR_21002010079/T2FLAIR_AXI"}}]')
    with httpx.Client(timeout=300) as clinet:
        clinet.post(url="{}{}".format(UPLOAD_DATA_API_URL,sync_urls.SYNC_PROT_OPE_NO),
                    json=data_list)